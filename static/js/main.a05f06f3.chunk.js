(this.webpackJsonpCRA_FS_Rasp=this.webpackJsonpCRA_FS_Rasp||[]).push([[0],{30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){"use strict";n.r(t),n.d(t,"_Date",(function(){return s})),n.d(t,"store",(function(){return G})),n.d(t,"APP_CONSTANTS",(function(){return d})),n.d(t,"APP_VARS",(function(){return f})),n.d(t,"SELECTORS",(function(){return q})),n.d(t,"bookingsDataUPD",(function(){return D})),n.d(t,"flyersDataUPD",(function(){return T})),n.d(t,"userDataUPD",(function(){return h})),n.d(t,"periodUPD",(function(){return y})),n.d(t,"EventUPD",(function(){return E})),n.d(t,"testActionMD",(function(){return L})),n.d(t,"getUser",(function(){return J})),n.d(t,"setUser",(function(){return K})),n.d(t,"logOut",(function(){return W})),n.d(t,"REQ_GETBOOKINGS",(function(){return be})),n.d(t,"getLastUpdate",(function(){return je})),n.d(t,"bookingsDataToObj",(function(){return oe})),n.d(t,"start",(function(){return Yn})),n.d(t,"getPeriod",(function(){return $n})),n.d(t,"updateBookings",(function(){return Zn}));var r=n(1),a=n.n(r),i=n(15),o=n.n(i),c=(n(30),n(31),n(32),n(5)),s={m30:18e5,hr24:864e5,GMToffset:6e4*(new Date).getTimezoneOffset(),longLocaleStrOptions:{weekday:"long",year:"numeric",month:"long",day:"numeric"},timeStrToMS:function(e){var t=e.split(/[.:\s]/);return t.length>2?Date.UTC(+t[2],+t[1]-1,+t[0],+t[3],+t[4]):6e4*(+t[1]+60*t[0])},dateMsToDateN:function(e){return Math.trunc(e/864e5)},dateToYYYYMMDD:function(e,t){t=t||"";var n=e.getFullYear(),r=+e.getMonth()+1,a=+e.getDate();return n+t+(r>9?r:"0"+r)+t+(a>9?a:"0"+a)},dateToLongStrRu:function(e){return e.toLocaleDateString("ru-RU",s.longLocaleStrOptions)},dayNumToCustomDateObj:function(e){var t=new Date(e*s.hr24);return s.customDate(t)},msToSlotN:function(e){var t=(e-s.dateMsToDateN(e)*s.hr24)/s.m30;return Math.trunc(t)},slotStrToMs:function(e){var t=e.split(/:/),n=Object(c.a)(t,2),r=n[0];return 6e4*(+n[1]+60*r)},msToCustomDateObj:function(e,t){!0===t&&(e-=s.GMToffset);var n=new Date(e);return s.customDate(n)},customDate:function(e){var t=e.getTime(),n=s.dateMsToDateN(t),r=e.getUTCMonth(),a=e.getUTCDate(),i="".concat(e.getUTCHours(),":").concat(+e.getUTCMinutes()>=30?"30":"00"),o=e.getUTCDay(),c=s.isHoliday(r,a,o);return{timeMS:t,timeStr:i,date:e,dateN:n,monthN:+r+1,dayN:a,dayName:["\u0412\u0441","\u041f\u043d","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041f\u0442","\u0421\u0431"][o],HDay:c}},isHoliday:function(e,t,n){return!(0!=n&&6!=n&&-1==[[1,2,3,4,5,6,7,8],[23,24],[8],[],[1,8,9],[12],[],[],[],[],[6],[]][e].indexOf(t))}},u=Object.freeze(function(){for(var e=[],t=0;t<=23;t++)e.push([2*t*s.m30,100*t+0,t+":00"],[2*t*s.m30+s.m30,100*t+30,t+":30"]);return e}());var l=n(13),d={bookingsAPIDataMap:{bookingIdCI:0,history:1,timeCI:2,timeValCI:3,tarif:4,fullname:5,notes:6,status:7,flyerId:8,email:9,phone:10},bookingsViewPosArr:["timeCI","timeValCI","tarif","fullname","notes","bookingIdCI","status","email","phone","flyerId","history"],bookingsArrMap:{timeCI:0,timeValCI:1,tarif:2,fullname:3,notes:4,bookingIdCI:5,status:6,email:7,phone:8,flyerId:9,history:10},flyersAPI_dataMap:{fullname:0,flyerId:2,catid:3,firstname:4,secondname:5,lastname:6,email:7,phone:8,notes:10},BT_DATES_OFFSET:{stOffset:-1,endOffset:3},FT_DATES_OFFSET:{stOffset:-1,endOffset:30},BASE_PATH:"/CRA_FTime_GITPAGE",DEFAULT_SOURCE:"GAS_MASTER_BS_URL",GAS_DEV_BS_URL:"https://script.google.com/macros/s/AKfycbyBZQxJxDw6N47Gvi6ZbUKYJI8KfQxElHzz9GThw72cpx_JsDeJbdKoDNSvz_igTGge/exec",GAS_MASTER_BS_URL:"https://script.google.com/macros/s/AKfycbzPmb05v6dC1lKDGSk7H5265KatlQbdLm8fWzGShh8zP0MdzR0t0ITJjVFuAuOW8D0-/exec",shiftChangeAppUrl:"https://nwpoul.github.io/ShiftChangeWEB/Index.html"},f={user:{name:"",mail:"",ps:"",role:""},bookingsData:{arr:[],obj:{},reqs:{},loading:!1,upd:0},flyersData:{arr:[],obj:{},upd:0,new:"",editorState:{},showEditor:!1,showModal:""},period:{reqDate:"",stDate:"",endDate:""},event:"",bookingsTable:{tableDateN:null,curTbodyInfo:{headerStr:"not set yet",dateN:""},testText:"bookingsTable initial test text"},freetimeTable:{minTime:15,tableDateN:null},sidebarState:{isToggled:!1,curObj:{},showModal:"",viewTime:null},testState:{testText:"initial test text",pending:!1,error:void 0,data:void 0}};function b(e){e.getState;return function(e){return function(t){return console.log("ACT: ",t.type,t.payload),e(t)}}}var m=Object(l.b)({name:"mainState",initialState:{user:f.user,period:f.period,bookingsData:f.bookingsData,flyersData:f.flyersData,event:f.event},reducers:{userDataUPD:function(e,t){Object.assign(e.user,t.payload)},periodUPD:function(e,t){e.period=t.payload},bookingsDataUPD:function(e,t){Object.assign(e.bookingsData,t.payload)},bookingsDayDataUPD:function(e,t){var n=t.payload,r=n.dayN,a=n.dayData;a?e.bookingsData.obj[r]=a:delete e.bookingsData.obj[r]},bookingsLoadingUPD:function(e,t){e.bookingsData.loading=t.payload},toggleFlyerEditorMD:function(e,t){var n;e.flyersData.showEditor=null!==(n=t.payload)&&void 0!==n?n:!e.flyersData.showEditor},flyersDataUPD:function(e,t){e.flyersData.raw=t.payload},newFlyerDataUPD:function(e,t){e.flyersData.raw.push(t.payload)},flyerEditorStateUPD:function(e,t){e.flyersData.editorState=t.payload},flyerEditorModalUPD:function(e,t){e.flyersData.showModal=t.payload},EventUPD:function(e,t){e.event=t.payload}}}),j=Object(l.b)({name:"bookingsTable",initialState:f.bookingsTable,reducers:{tbodyInViewUPD:function(e,t){e.curTbodyInfo=t.payload},bTableDateUPD:function(e,t){e.tableDateN=t.payload}}}),O=Object(l.b)({name:"freetimeTable",initialState:f.freetimeTable,reducers:{minTimeUPD:function(e,t){e.minTime=t.payload},ftTableDateUPD:function(e,t){e.tableDateN=t.payload}}}),p=Object(l.b)({name:"testState",initialState:f.testState,reducers:{testActionMD:function(e,t){e.testText=JSON.stringify(t.payload)},pendingUPD:function(e,t){e.pending=t.payload},errorUPD:function(e,t){e.error=t.payload},dataUPD:function(e,t){e.data=t.payload}}}),g=Object(l.b)({name:"sidebar",initialState:f.sidebarState,reducers:{toggleSidebarMD:function(e,t){var n;e.isToggled=null!==(n=t.payload)&&void 0!==n?n:!e.isToggled},sidebar_curObjUPD:function(e,t){var n;e.curObj=null!==(n=t.payload)&&void 0!==n?n:{}},bookingEditorModalUPD:function(e,t){e.showModal=t.payload},sidebar_viewTimeUPD:function(e,t){e.viewTime=t.payload}}}),v=m.actions,h=v.userDataUPD,y=v.periodUPD,D=v.bookingsDataUPD,T=(v.bookingsDayDataUPD,v.bookingsLoadingUPD,v.flyersDataUPD),S=v.newFlyerDataUPD,x=v.flyerEditorStateUPD,N=v.toggleFlyerEditorMD,I=v.flyerEditorModalUPD,E=v.EventUPD,w=j.actions,k=w.tbodyInViewUPD,C=w.bTableDateUPD,_=O.actions,M=_.minTimeUPD,A=_.ftTableDateUPD,B=g.actions,P=B.toggleSidebarMD,V=B.sidebar_curObjUPD,U=B.bookingEditorModalUPD,F=B.sidebar_viewTimeUPD,R=p.actions,L=R.testActionMD,q=(R.pendingUPD,R.errorUPD,R.dataUPD,{bookingsObj:function(e){return e.mainState.bookingsData.obj},bookingsDayObj:function(e){return function(t){return t.mainState.bookingsData.obj[e]}},bookingsObjDateNs:function(e){return function(t){return Object.fromEntries(e.map((function(e){return[e,t.mainState.bookingsData.obj[e]]})))}},bookingsUpd:function(e){return e.mainState.bookingsData.upd},instrRequests:function(e){return e.mainState.bookingsData.reqs},flyersData:function(e){return e.mainState.flyersData},flyersData_showEditor:function(e){return e.mainState.flyersData.showEditor},flyersData_showModal:function(e){return e.mainState.flyersData.showModal},flyersDataRaw:function(e){return e.mainState.flyersData.raw},flyersData_newName:function(e){return e.mainState.flyersData.newName},flyersData_editorState:function(e){return e.mainState.flyersData.editorState},userObj:function(e){return e.mainState.user},period:function(e){return e.mainState.period},event:function(e){return e.mainState.event},curTbodyInfo:function(e){return e.bookingsTable.curTbodyInfo},bTableDateN:function(e){return e.bookingsTable.tableDateN},ftTableDateN:function(e){return e.freetimeTable.tableDateN},minTime:function(e){return e.freetimeTable.minTime},sidebar:function(e){return e.sidebar},sidebar_isToggled:function(e){return e.sidebar.isToggled},sidebar_curObj:function(e){return e.sidebar.curObj},sidebar_InitData:function(e){return"INIT"==e.sidebar.curObj.type?e.sidebar.curObj:null},booking_showModal:function(e){return e.sidebar.showModal},sidebar_viewTime:function(e){return e.sidebar.viewTime},testText:function(e){return e.testState.testText},testFetchState:function(e){return e.testState}}),G=Object(l.a)({reducer:{mainState:m.reducer,bookingsTable:j.reducer,freetimeTable:O.reducer,sidebar:g.reducer,testState:p.reducer},middleware:function(e){return e({immutableCheck:{warnAfter:600},serializableCheck:{warnAfter:600}}).concat(b)}});function H(e){return function(t,n){var r=d.BT_DATES_OFFSET,a=r.stOffset,i=r.endOffset,o=q.bTableDateN(n()),c=q.curTbodyInfo(n()).dateN,s=e.dateN,u=s==+o+a&&s==c-1?+o+a:s==+o+i&&s==+c+1?+o+i:null;console.log("THUNK: ViewDate: ".concat(c||"n/a"," -> ").concat(s," tableDate: ").concat(o," -> ").concat(u)),t(u?C(u):k(e))}}function K(){if(localStorage.getItem("name")&&localStorage.getItem("role")){var e={name:localStorage.getItem("name"),ps:localStorage.getItem("ps"),role:localStorage.getItem("role")};t="loginButton",(n=e.name.slice(0,6))&&t&&(document.getElementById(t).innerText=n)}var t,n}function J(){return q.userObj(G.getState())}function W(){localStorage.clear(),G.dispatch(h({name:"",ps:"",role:"",mail:""}))}var Y=n(2),z=n.n(Y),X=n(6),Q={method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded"}};function Z(e){return e.ok?Promise.resolve(e):Promise.reject(new Error(e.statusText))}function $(e){return e.json()}function ee(e){var t,n,r=(null===e||void 0===e||null===(t=e.content)||void 0===t||null===(n=t.slice)||void 0===n?void 0:n.call(t,0,5))||JSON.stringify(e).slice(0,70);return console.log("JSON fetched: ".concat(r," ...")),e}function te(e,t){return console.log("fetch err: ",e),t(e),e}function ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e,r=t.params,a=t.options,i=void 0===a?Q:a;if("POST"===i.method)for(var o in r)i.body.append(o,encodeURIComponent(r[o]));else if(r)for(var c in n+="?",r)n+="&".concat(c,"=").concat(encodeURIComponent(r[c]));return[n,i]}function re(e,t){return ae.apply(this,arguments)}function ae(){return(ae=Object(X.a)(Y.mark((function e(t,n){var r,a,i,o;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ne(t,n),a=Object(c.a)(r,2),i=a[0],o=a[1],e.abrupt("return",fetch(i,o).then(Z).then($).then(ee).catch(te));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e){var t=d.bookingsAPIDataMap,n=d.bookingsViewPosArr,r=n.indexOf("timeCI"),a={};return[e.map((function(e){var r=e.slice();return r[t.timeCI]=Date.parse(r[t.timeCI])-s.GMToffset,"\u0417\u0430\u043f\u0440\u043e\u0441"===r[t.status]&&(a[r[t.bookingIdCI]]=function(e,t){var n=JSON.parse(e[t.history])[0],r=n.time,a=n.user;return{id:e[t.bookingIdCI],timeFlight:e[t.timeCI],reqTime:r,user:a}}(r,t)),n.map((function(e){return r[t[e]]}))})).sort((function(e,t){return e[r]-t[r]})),a]}function oe(e){for(var t=d.bookingsArrMap,n=t.timeCI,r=t.timeValCI,a=r,i=r+1,o=ie(e),l=Object(c.a)(o,2),f=l[0],b=l[1],m=f[0].length,j=new Array(m-a).fill(""),O=s.dateMsToDateN(f[0][n]),p=s.dateMsToDateN(f[f.length-1][n])+1,g={},v=function(e,t){for(var n={},r=function(e){n[e]={},u.forEach((function(t){n[e][t[0]/s.m30]=_(t[0],0)}))},a=e;a<=t;a++)r(a);return n}(O,p),h=0;f[h+1];h++){var y=f[h][n],D=f[h][r],T=M(y),S=Object(c.a)(T,3),x=S[0],N=S[1],I=S[2],E=D,w=_(N,E);w[i]=[f[h].slice(a)],k(),v[x][I]=w,C()}return delete v[p],x>O?delete v[x]:console.log("last date with data = st.date, the last date obj incomplete!"),g.arr=f,g.obj=v,g.reqs=b,g;function k(){for(;(null===(e=f[h+1])||void 0===e?void 0:e[n])==y;){var e;E+=f[h+1][r],w[i].push(f[h+1].slice(a)),h++}w[r]=E}function C(){for(;E>30;){w[r]=30,E-=30;var e=M(y+=s.m30),t=Object(c.a)(e,3);x=t[0],N=t[1],I=t[2],(w=_(N,E))[i][0][1]="-----",k(),v[x][I]=w}E=0}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=[];return a[n]=e,a[r]=t,a[i]=[j.slice()],a}function M(e){var t=s.dateMsToDateN(e),n=e-t*s.hr24;return[t,n,n/s.m30]}}var ce=d.DEFAULT_SOURCE,se=function(e){return!(200!=e.status||!e.content)},ue=function(e,t,n){t.status="ERROR: "+(null===n||void 0===n?void 0:n.status);try{t.data=JSON.parse(n)}catch(r){t.data=n}return console.warn("API_".concat(e," answer is INVALID!"),t),t},le=function(e){return e.content};function de(e){return fe.apply(this,arguments)}function fe(){return(fe=Object(X.a)(Y.mark((function e(t){var n,r,a,i,o,c,s,u,l,f,b,m,j,O,p;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.command,r=t.requestObj,a=void 0===r?{}:r,i=t.source,o=void 0===i?ce:i,c=t.validation,s=void 0===c?se:c,u=t.modification,l=void 0===u?le:u,console.log("API_".concat(n),a),f={status:"LOADING",data:null},b=J(),e.t0=o,e.next="GAS_DEV_BS_URL"===e.t0||"GAS_MASTER_BS_URL"===e.t0?7:13;break;case 7:return m=d[o],(j={id:{nick:b.name,mail:b.mail,ps:b.ps},command:n,data:a}).id=JSON.stringify(j.id),j.data=JSON.stringify(j.data),O={method:"GET"},e.abrupt("break",13);case 13:return e.next=15,re(m,{params:j,options:O});case 15:if(p=e.sent,s(p)){e.next=18;break}return e.abrupt("return",ue(n,f,p));case 18:return f.status="OK",f.data=l(p),e.abrupt("return",f);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e){return me.apply(this,arguments)}function me(){return(me=Object(X.a)(Y.mark((function e(t){var n,r,a,i,o,c,s,u,l,d,f,b,m;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.stDate,r=t.endDate,a=t.days,i=void 0===a?5:a,o=t.validation,c=t.modification,s=t.source,n=new Date(n),r=new Date(r),isNaN(n)&&(n=new Date),isNaN(r)&&(r=new Date(n)).setHours(24*(i-1),0,0,0),u=!0,l={stDate:n,endDate:r},d="rasp",e.next=13;break;case 12:u=!1;case 13:return e.next=15,de({requestObj:l,command:d,validation:o,modification:c,source:s});case 15:if("OK"!==(f=e.sent).status){e.next=20;break}return b=f.data,m=oe(b),e.abrupt("return",pe(m,u));case 20:return console.log("ERROR IN REQ_GETBOOKINGS!"),e.abrupt("return",null);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(e){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(X.a)(Y.mark((function e(t){var n,r,a,i,o,c;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.validation,r=t.modification,a=t.source,i=void 0===a?ce:a,o=t.subject,c={bookings:"GET_LAST_BOOKINGSUPD",flyers:"GET_LAST_FLYERSUPD"}[void 0===o?"bookings":o],e.next=5,de({command:c,validation:n,modification:r,source:i});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t||window.localStorage.setItem("bookingsData",JSON.stringify(e)),G.dispatch(D(e))}function ge(){return ve.apply(this,arguments)}function ve(){return(ve=Object(X.a)(Y.mark((function e(){var t,n;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!0,"getFlyers",e.next=4,de({command:"getFlyers"});case 4:if("OK"!==(n=e.sent).status){e.next=8;break}return n=n.data,e.abrupt("return",he(n,t));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t||window.localStorage.setItem("flyersData",JSON.stringify(e)),G.dispatch(T(e))}function ye(e){return De.apply(this,arguments)}function De(){return(De=Object(X.a)(Y.mark((function e(t){var n,r;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.bookingId,r={bookingId:n},"cancelBooking",e.next=5,de({requestObj:r,command:"cancelBooking"});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Te(e){return Se.apply(this,arguments)}function Se(){return(Se=Object(X.a)(Y.mark((function e(t){return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"changeBooking",e.next=3,de({requestObj:t,command:"changeBooking"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(e){return Ne.apply(this,arguments)}function Ne(){return(Ne=Object(X.a)(Y.mark((function e(t){var n,r;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!!t.instrMode,r=n?"addBooking_instrMode":"addBooking",e.next=4,de({requestObj:t,command:r});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(){return(Ie=Object(X.a)(Y.mark((function e(t){return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"addFlyer",e.next=3,de({requestObj:t,command:"addFlyer"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ee=n(3),we=n(11),ke=n(7),Ce=[],_e=function(e,t){if(void 0!==e&&null!==e&&void 0!==t&&null!==t)return Ce=[].concat(Object(ke.a)(Ce),[[e,t]]),function(){Ce=Ce.filter((function(e){return e[1]!==t}))}},Me=function(e){var t=[],n=e.type;"string"===typeof e?(n=e,t.push({type:n})):t.push(e),console.dir("EVNT: ".concat(n)),Ce.forEach((function(e){var r=Object(c.a)(e,2),a=r[0],i=r[1];"string"===typeof a&&a!==n||("function"!==typeof a||a.apply(void 0,t))&&i.apply(void 0,t)}))},Ae=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Object(r.useEffect)((function(){return _e(e,t)}),n),Me},Be=n(0);console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/CRA_FTime_GITPAGE",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_MY_ENV:"Some value"}));var Pe=d.shiftChangeAppUrl,Ve=function(){return Object(Be.jsx)("span",{style:{width:"2em"}})},Ue=function(){return Object(Be.jsx)("button",{id:"shiftsButton",className:"navButton",onClick:function(){return window.open(Pe)},children:Object(Be.jsx)("b",{children:"Shifts"})})},Fe=function(e){var t=e.command,n=(e.mode,{prev:Object(Be.jsx)("b",{children:"\xab"}),next:Object(Be.jsx)("b",{children:"\xbb"})});return Object(Be.jsx)("button",{id:t+"Button",className:"navButton",onClick:function(){Me({type:"@@ui/NAV_BTN_CLICK",payload:t})},children:n[t]})},Re=function(){return Object(Be.jsxs)("div",{id:"bottomBar",className:"bottomBar",children:[Object(Be.jsx)(Ue,{}),Object(Be.jsx)(Ve,{}),Object(Be.jsx)(Fe,{command:"prev",mode:"..."}),Object(Be.jsx)(Ve,{}),Object(Be.jsx)(Fe,{command:"next",mode:"..."}),Object(Be.jsx)(Ve,{}),Object(Be.jsx)(qe,{})]})},Le=Object(r.memo)(Re);function qe(){if(!d.DEFAULT_SOURCE.includes("DEV"))return null;return Object(Be.jsx)("button",{id:"testButton",className:"navButton",onClick:function(){Me("@@ui/TEST_BTN4")},style:{backgroundColor:"red",color:"white"},children:"TEST/DEV"})}function Ge(){var e,t,n=Object(Ee.d)(q.userObj),r="admin"===(null===n||void 0===n?void 0:n.role),a=Object(Ee.d)(q.instrRequests);if(!a||0===Object.keys(a).length)return null;var i=[];if(Object.values(a).forEach((function(e){var t=e.id,a=e.timeFlight,o=e.user,c=e.reqTime;(r||o===(null===n||void 0===n?void 0:n.name))&&(c="".concat(c.slice(0,5).replace(".","/"),"  ").concat(c.slice(12,17)),i.push(Object(Be.jsx)("option",{value:JSON.stringify({id:t,timeFlight:a}),children:"".concat(o," ").concat(c,":   ID:").concat(t)},t)))})),!i.length)return null;var o=Object(Be.jsxs)("option",{value:null===(e=i[0])||void 0===e||null===(t=e.props)||void 0===t?void 0:t.value,children:["\u0417\u0430\u043f\u0440\u043e\u0441\u043e\u0432: ",i.length]},"placeholder");return Object(Be.jsxs)("select",{id:"instrRequests",onChange:function(e){var t,n=JSON.parse(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value),r=n.id,a=n.timeFlight;console.log(r,new Date(a).toLocaleString()),Me({type:"@@ui/EDIT_BOOKING_CALL",payload:r})},children:[o,i]})}var He={bookings:{href:"./freetime",HMBtn:Object(Be.jsx)(Ze,{})},freetime:{href:"./bookings",HMBtn:Object(Be.jsx)($e,{})},default:{href:"./bookings",HMBtn:Object(Be.jsx)(Ze,{})}},Ke=function(){return Object(Be.jsx)("span",{style:{width:"1em"}})},Je="ru",We={day:"2-digit",month:"2-digit",year:"2-digit"},Ye=function(e){var t;$n(new Date((null===(t=e.target)||void 0===t?void 0:t.value)||e))};function ze(){var e,t=null===(e=Object(Ee.d)(q.period))||void 0===e?void 0:e.reqDate,n=new Date(t).toLocaleString(Je,We);return Object(Be.jsxs)("button",{id:"reqDateButton",className:"reqDateButton",children:[n||"...",Object(Be.jsx)("input",{type:"date",id:"reqDateInput",onChange:Ye,name:"reqDate"})]})}function Xe(){return Object(Be.jsx)("button",{id:"reloadButton",onClick:Zn,children:Object(Be.jsx)("b",{children:"\u21bb"})})}function Qe(){var e,t=Object(Ee.c)(),n=Object(Ee.d)(q.userObj);return Object(Be.jsx)("button",{id:"loginButton",onClick:function(e){return function(e){"Log in"!==e.target.innerText&&window.confirm("\u0432\u044b\u0439\u0442\u0438?")&&(t(L("logOut()")),W())}(e)},children:(null===n||void 0===n||null===(e=n.name)||void 0===e?void 0:e.slice(0,6))||"Log in"})}function Ze(){return Object(Be.jsx)("button",{id:"homeButton",onClick:function(){Me("@@ui/HOME_BTN_click")},children:Object(Be.jsx)("b",{children:"\u2302"})})}function $e(){var e=Object(Ee.c)(),t=Object(Ee.d)(q.minTime);return Object(Be.jsx)("button",{id:"setMintimeButton",onClick:function(){var t=prompt("Looking for ... (min)",15);e(M(t))},children:t+"'"||!1})}function et(e){var t=e.href;return Object(Be.jsx)("button",{id:"routedModeButton",onClick:function(){Object(we.navigate)(t),console.dir("call "+t)},children:"\u274b"})}var tt=function(e){var t=e.mode,n=He[t]||He.default,r=n.HMBtn,a=n.href;return Object(Be.jsxs)("div",{className:"buttonBar",children:[Object(Be.jsx)(ze,{}),Object(Be.jsx)(Ke,{}),r,Object(Be.jsx)(Ke,{}),Object(Be.jsx)(Xe,{}),Object(Be.jsx)(Ke,{}),Object(Be.jsx)(et,{href:a}),Object(Be.jsx)(Ke,{}),Object(Be.jsx)(Qe,{}),Object(Be.jsx)(Ke,{}),Object(Be.jsx)(Ge,{})]})},nt=(n(52),n(8));function rt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cur",n=9,r={cur:e,prev:+e-1,next:+e+1},a=r[t],i=a*s.hr24+60*n*60*1e3;at(i)}function at(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t={block:"center"},n=document.getElementById("inner"),r=document.getElementById("mainTable");if(r&&n){var a=s.dateMsToDateN(e),i=u[s.msToSlotN(e)],o="".concat(a,"_").concat(i[2]),c=document.getElementById(o);if(c){var l=c.getBoundingClientRect(),d=n.getBoundingClientRect();return l.top-d.top>70&&d.bottom-l.bottom>10||(console.dir("scroll to (".concat(o,")")),c.scrollIntoView(t)),c}var f=it(r,o,t);setTimeout((function(){f.disconnect()}),5e3)}}function it(e,t,n){e=e||document.getElementById("mainTable");var r=(t+"_").split("_"),a=Object(c.a)(r,2),i=a[0],o=a[1],s=function(e,t){t.disconnect(),e.scrollIntoView(n)},u=new MutationObserver((function(e,n){var r,a=Object(nt.a)(e);try{for(a.s();!(r=a.n()).done;){var c=r.value;if("childList"===c.type){var u,l=Object(nt.a)(c.addedNodes);try{for(l.s();!(u=l.n()).done;){var d=u.value;if(d.id==i){var f,b;if(o)d=null===(f=(b=document).getElementById)||void 0===f?void 0:f.call(b,t);return s(d,n)}}}catch(m){l.e(m)}finally{l.f()}}}}catch(m){a.e(m)}finally{a.f()}}));return u.takeRecords(),u.observe(e,{childList:!0}),u}var ot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Object(r.useRef)(!1),i=Object(r.useRef)(null),o=Object(r.useRef)(),c=Object(r.useCallback)((function(t){var r,o=(null===(r=t[0])||void 0===r?void 0:r.isIntersecting)||!1;e(t),o&&!a.current&&i.current&&n&&(i.current.disconnect(),i.current=null,a.current=!0)}),[e,n,i,a]);return Object(r.useEffect)((function(){return a.current||i.current||(i.current=new IntersectionObserver(c,t),i.current.observe(o.current)),function(){i.current&&(i.current.disconnect(),i.current=null)}}),[c,t,o]),o},ct=function(e){return Me({type:"@@ui/ADDREC_BTN",payload:e.target})};function st(e){var t=e.freeTimeText;return Object(Be.jsx)("button",{className:"freeTimeButton",onClick:ct,children:t})}var ut=function(e){return Me({type:"@@ui/EDIT_BOOKING_CALL",payload:e.target.innerText})};function lt(e){var t=e.bookingId;return Object(Be.jsx)("button",{className:"editRecButton",onClick:ut,children:t})}var dt=function(){return Me({type:"@@ui/TBHEADER_CLICK",payload:"header Click "+Date.now()})};function ft(e){var t=e.dateObj,n=e.headerStr,r=e.colsCnt;return Object(Be.jsxs)("tr",{id:t.dateN+"_0",className:t.HDay?"newDayTr HDay":"newDayTr",children:[Object(Be.jsxs)("th",{children:[t.dayName,", ",t.dayN,"/",t.monthN]}),Object(Be.jsx)("td",{}),Object(Be.jsx)("td",{colSpan:r-1,onClick:dt,children:n})]})}function bt(e){var t=e.dayDataObj,n=e.dateN,r=e.ADMIN_TOGGLE,a=e.instrRequests,i=e.sidebar_viewTime,o=d.bookingsArrMap,c=o.timeCI,u=o.timeValCI,l=o.bookingIdCI,f=u+1,b=vt,m=Date.now()-s.GMToffset,j=s.msToCustomDateObj(n*s.hr24),O=n,p=function(e){var t=s.dateToLongStrRu(e.date);return"".concat(t," ").concat(e.HDay?" (\u0432\u044b\u0445)":" (\u0431\u0443\u0434\u0435\u043d\u044c)")}(j),g=[];for(var v in t){var h=[],y=Number(v),D=j.timeMS+t[v][c],T=s.msToCustomDateObj(D).timeStr,S=30-t[v][u],x=null===a||void 0===a?void 0:a.has(D),N=D===i,I=t[v][f],E=I.length+Number(S>=2&&S<30),w=B(E,T),k="".concat(n,"_").concat(T),C=mt({freeTime:S,minFreeTime:2,timeSlotN:y,curTime:D,nowTime:m,instrReq:x,matchSidebarTime:N}),_=S>=30?[P(b)]:V(I[0]),M=Object(Be.jsxs)("tr",{id:k,className:C,children:[w,_]},k);if(h.push(M),E>1){var A=U(v,C,I.slice(1));h.push(A)}S>=2&&S<30&&h.push(Object(Be.jsx)("tr",{className:C,children:P(b,S)},"adTr"+v)),g.push.apply(g,h)}return{colsCnt:b,curDateObj:j,tbodyId:O,headerStr:p,rowsJSXArr:g};function B(e,t){return Object(Be.jsxs)("th",{rowSpan:e,children:[t,Object(Be.jsx)("br",{}),Object(Be.jsx)("span",{className:"tdSpan"})]})}function P(e,t){var n="-- \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e ".concat(t?t+" \u043c\u0438\u043d.":""," --");return Object(Be.jsx)("td",{colSpan:e,className:"freeTimeTd",children:Object(Be.jsx)(st,{freeTimeText:n})},"ft")}function V(e){var t=e[l-1],n=e.slice(0,b-1).map((function(e,t){return Object(Be.jsx)("td",{className:"pf",children:Object(Be.jsx)("pre",{children:e})},"pf"+t)}));return r&&t&&(n[l-1]=Object(Be.jsx)("td",{className:"pf",children:Object(Be.jsx)(lt,{bookingId:t})},"pf"+l-1)),n}function U(e,t,n){return n.map((function(n,r){return Object(Be.jsx)("tr",{className:t,children:V(n)},e+"_"+r)}))}}function mt(e){var t=e.freeTime,n=e.minFreeTime,r=e.timeSlotN,a={dayNight:r<=17?"groupN":"groupD",oddity:r%2?"odd":"even",noTime:t<=n?"noTime-book":"",pastTime:e.curTime<e.nowTime?"pastSlot":"",instrReq:e.instrReq?"instrReq":"",matchSidebarTime:e.matchSidebarTime?"bt-sidebar_viewTime":""};return Object.values(a).reduce((function(e,t){return e.concat(" ",t)}))}function jt(e){var t=e.dateN,n=e.dayDataObj,r=e.instrRequests,a=Object(Ee.c)(),i=bt({dayDataObj:n,dateN:t,ADMIN_TOGGLE:"admin"===Object(Ee.d)(q.userObj).role,instrRequests:r,sidebar_viewTime:Object(Ee.d)(q.sidebar_viewTime)}),o=i.colsCnt,c=i.curDateObj,s=i.headerStr,u=i.tbodyId,l=i.rowsJSXArr,d=function(e){var t=e.tbodyData,n=e.dispatcher;return{intersectOptions:{root:null,rootMargin:"-20% 0% -80% 0%"},intersectFunc:function(e){e[0].isIntersecting&&n(H(t))}}}({tbodyData:{headerStr:s,dateN:t},dispatcher:a}),f=d.intersectFunc,b=d.intersectOptions,m=ot(f,b);return Object(Be.jsxs)("tbody",{ref:m,id:u,className:"bookingsTable",children:[Object(Be.jsx)(ft,{dateObj:c,headerStr:s,colsCnt:o}),l]})}var Ot=["Time",Object(Be.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 16 16",children:Object(Be.jsx)("path",{d:"M8 3.019v-1.019h2v-1c0-0.552-0.448-1-1-1h-3c-0.552 0-1 0.448-1 1v1h2v1.019c-3.356 0.255-6 3.059-6 6.481 0 3.59 2.91 6.5 6.5 6.5s6.5-2.91 6.5-6.5c0-3.422-2.644-6.226-6-6.481zM11.036 13.036c-0.944 0.944-2.2 1.464-3.536 1.464s-2.591-0.52-3.536-1.464c-0.944-0.944-1.464-2.2-1.464-3.536s0.52-2.591 1.464-3.536c0.907-0.907 2.101-1.422 3.377-1.462l-0.339 4.907c-0.029 0.411 0.195 0.591 0.497 0.591s0.527-0.18 0.497-0.591l-0.339-4.907c1.276 0.040 2.47 0.555 3.377 1.462 0.944 0.944 1.464 2.2 1.464 3.536s-0.52 2.591-1.464 3.536z"})}),"tarif","Flyers","Notes","Booking \u2116","paid"],pt=Ot.concat(["mail","phone"]),gt=pt.slice(1).map((function(e,t){return Object(Be.jsx)("th",{className:"th-header",children:e},t)})),vt=pt.length,ht=d.BT_DATES_OFFSET,yt=function(){return Object(Be.jsx)("tbody",{className:"bt-serv-tbody",children:Object(Be.jsx)("tr",{children:Object(Be.jsxs)("td",{colSpan:vt,className:"bt-serv-td",children:[Object(Be.jsx)("br",{}),Object(Be.jsx)("br",{}),Object(Be.jsx)("br",{})," NO DATA ",Object(Be.jsx)("br",{})]})})})},Dt=function(e){return function(t){rt(e,t.payload)}};function Tt(){var e=Object(Ee.c)(),t=Object(Ee.d)(q.curTbodyInfo),n=t.dateN;return Ae("@@ui/NAV_BTN_CLICK",Dt(n),[n]),Object(Be.jsx)("div",{id:"curDayDiv",className:"curDayDiv",onClick:function(){return e(L("HEAD DIV Click "+Date.now()))},children:t.headerStr})}function St(){return Object(Be.jsx)("tbody",{id:"btHeaderTbody",children:Object(Be.jsxs)("tr",{id:"btHeaderTr",className:"tableHeader",children:[Object(Be.jsx)("th",{id:"th0",className:"th-header th0",children:pt[0]}),gt]})})}function xt(e){var t=e.dateNsArr,n=Object(Ee.d)(q.bookingsObjDateNs(t),Ee.b),r=Object(Ee.d)(q.instrRequests);r=r?new Set(Object.values(r).map((function(e){return e.timeFlight}))):null;return t.map((function(e,t){return n[e]?Object(Be.jsx)(jt,{dateN:e,dayDataObj:n[e],instrRequests:r},e):(!0,Object(Be.jsx)(yt,{},e))}))}var Nt=function(){var e=ht.stOffset,t=ht.endOffset,n=Object(Ee.c)(),a=Object(Ee.d)(q.sidebar_viewTime),i=Object(Ee.d)(q.bTableDateN),o=Object(Ee.d)(q.period,Ee.b).reqDate,c=new Date(o).getTime()||Date.now(),u=s.dateMsToDateN(c),l=Array.from({length:1+t-e},(function(t,n){return+i+(e+n)}));return Object(r.useEffect)((function(){n(C(u)),rt(u)}),[u,n]),function(e){Object(r.useEffect)((function(){if(e){var t=q.bTableDateN(G.getState()),n=s.dateMsToDateN(e);n>=t+ht.stOffset&&n<=t+ht.endOffset||G.dispatch(C(n)),at(e)}}),[e])}(a),Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsx)(Tt,{}),Object(Be.jsxs)("table",{id:"mainTable",className:"bookingsTable",children:[Object(Be.jsx)(St,{}),Object(Be.jsx)(xt,{dateNsArr:l})]})]})};n(53);var It=function(e,t,n){var a=e?function(e,t){var n=s.dateMsToDateN(e),r=s.msToSlotN(e),a=t.indexOf(n)+1;return a>0?"r"+(r+1)+"c"+a:null}(e,t):null;return Object(r.useEffect)((function(){if(e){if(!a){var t=s.dateMsToDateN(e);return n(A(t)),null}!function(e){var t={behavior:"smooth",block:"center",inline:"center"},n=40,r=0,a=20,i=document.getElementById("inner");if(!document.getElementById("mainTable")||!i)return;var o=document.getElementById(e);if(!o)return;var c=o.getBoundingClientRect(),s=i.getBoundingClientRect();if(c.top-s.top>a&&s.bottom-c.bottom>a&&c.left-s.left>n&&s.right-c.right>r)return;console.dir("scroll to (".concat(e,")")),o.scrollIntoView(t)}(a)}}),[e,a,n]),a};var Et=d.FT_DATES_OFFSET;function wt(e){var t="TD"===e.target.nodeName?e.target.id:null;if(t){var n=function(e){return e.slice(1).split("c").map((function(e){return Number(e)-1}))}(t),r=Object(c.a)(n,2),a=r[0],i=r[1];if(!(a<0||i<0)){var o=u[a],l=q.ftTableDateN(G.getState())+Et.stOffset+i,d=s.dayNumToCustomDateObj(l);Me({type:"@@ui/FT_CELL_CLICK",payload:+d.timeMS+o[0]})}}}function kt(e,t){var n=t.stOffset,r=t.endOffset;return Array.from({length:1+r-n},(function(t,r){return+e+(n+r)}))}function Ct(e){var t=e.minTime,n=e.bokingsAllDataObj,r=e.daysNs,a=e.tdBookingEd,i=s.dateMsToDateN(Date.now()),o=Array.from(u,(function(){return[]}));return o.unshift([]),r.forEach((function(e,r){var c=n[e];if(c){var u=s.dayNumToCustomDateObj(+e),l=u.HDay?"HDay":"",d="".concat(u.dayN,"/").concat(u.monthN),f=e<i,b=r+1;o[0][b]=Object(Be.jsx)("td",{className:"td-header ".concat(l," ").concat(f?"isPast":""),children:d},b),function(e){var t=e.ci,n=e.dayBokingData,r=e.tdArr,a=e.HDay,i=e.isPast,o=e.minTime,c=e.tdBookingEd;Object.keys(n).forEach((function(e,s){var u=s+1,l="r"+u+"c"+t,d=30-n[e][1],f=function(e){var t=e.minTime,n=e.ri,r=e.freeTimeVal,a="";return r>28?a="fullTime":r<2?a="noTime":r<t&&(a="lessTime"),e.HDay&&n>=21&&n<=41&&(a+=" tdHDay"),e.isPast&&(a+=" isPast"),e.isInBED&&(a+=" isInBED"),a}({freeTimeVal:d,minTime:o,ri:u,HDay:a,isPast:i,isInBED:l==c});r[u][t]=Object(Be.jsx)("td",{id:l,className:f||null,children:d},l)}))}({ci:b,dayBokingData:c,tdArr:o,HDay:l,isPast:f,minTime:t,tdBookingEd:a})}})),o}var _t=function(e){var t=e.children;return Object(Be.jsxs)("tr",{className:"tableHeader",children:[Object(Be.jsx)("th",{id:"r0c0",className:"th0",children:"Slot"}),t]})};function Mt(e){var t=e.ri,n=e.thText,r=e.children,a=function(e){var t=e<=18?"groupN":"groupD";return e%2&&(t+=" odd"),37!=e&&41!=e||(t+=" trPrimeTime"),t}(t);return Object(Be.jsxs)("tr",{className:a,children:[Object(Be.jsx)("th",{className:a,id:"r".concat(t,"c0"),children:n}),r]})}var At=function(){var e=u,t=Object(Ee.c)(),n=Object(Ee.d)(q.minTime),a=Object(Ee.d)(q.bookingsObj),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Et,t=Object(Ee.d)(q.period,Ee.b).reqDate,n=new Date(t).getTime()||Date.now(),r=s.dateMsToDateN(n),a=Object(Ee.d)(q.ftTableDateN)||r,i=kt(a,e);return{reqDateN:r,tableDateN:a,daysNs:i}}(),o=i.tableDateN,c=i.reqDateN,l=i.daysNs,d=Object(Ee.d)(q.sidebar_viewTime),f=It(d,l,t);Object(r.useEffect)((function(){t(A(c))}),[c,t]),Ae("@@ui/NAV_BTN_CLICK",(function(e){var n="next"===e.payload?o+14:o-14;t(A(n))}),[o]);var b=Ct({minTime:n,bokingsAllDataObj:a,daysNs:l,tdBookingEd:f}),m=[Object(Be.jsx)(_t,{children:b[0]},"tr0")];return e.forEach((function(t,n){var r=e[n][2];m[n+1]=Object(Be.jsx)(Mt,{ri:n+1,thText:r,children:b[n+1]},r)})),Object(Be.jsx)("table",{id:"mainTable",className:"freetimeTable",onClick:wt,children:Object(Be.jsx)("tbody",{id:"freeTimeTbody",children:m})})},Bt=At,Pt=n(4),Vt=n(10);n(54);var Ut=function(e){var t=e.message,n=void 0===t?"":t,a=e.closeAction,i=e.timeout;Object(r.useEffect)((function(){if(i&&a){var e=setTimeout(a,i);return function(){return clearTimeout(e)}}}),[i,a]);var o="loginInfoBtn";return n.includes("SUBMITTING")&&(o+=" hidden"),n.includes("Error")&&(o+=" error"),Object(Be.jsxs)("div",{id:"loginInfo",children:[n,Object(Be.jsx)("br",{}),Object(Be.jsx)("br",{}),Object(Be.jsx)("button",{onClick:a,className:o,children:"OK"})]})};function Ft(e){var t={},n=function(e){var t={status:!1,content:""};return console.log(e),e?void 0!==!e.status&&e.content?/200/.test(e.status)?(t.status=!0,t.content=e.content):/20\d/.test(e.status)?(t.status=e.status,t.content=e.content):t.content="Error!: \n ".concat(e.content):t.content="Invalid response: \n ".concat(e):t.content="No response!",t}(e);if(!0===n.status){var r=n.content,a={name:r.nick,mail:r.mail,ps:r.ps,role:r.role};t={status:"SUCSESS",message:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c ".concat(a.name,"\n                           \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d!"),action:function(){return function(e){var t=e.name,n=e.mail,r=e.ps,a=e.role,i=void 0===a?"user":a;localStorage.setItem("name",t),localStorage.setItem("mail",n),localStorage.setItem("ps",r),localStorage.setItem("role",i),G.dispatch(h({name:t,mail:n,ps:r,role:i}))}(a)}}}else t=201==n.status?{status:"PENDING",message:n.content,action:function(){}}:{status:!1,message:n.content,action:function(){}};return t}function Rt(e){return Lt.apply(this,arguments)}function Lt(){return(Lt=Object(X.a)(z.a.mark((function e(t){var n,r,a,i,o;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d[d.DEFAULT_SOURCE],"login",r={mail:t.email,ps:t.password},a={command:"login",data:JSON.stringify(r)},i={method:"GET"},e.next=7,re(n,{params:a,options:i});case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qt(e){return function(){var t=Object(X.a)(z.a.mark((function t(n){var r,a,i,o;return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.time("getSubmit"),t.next=3,Rt(n);case 3:r=t.sent,null===(a=Ft(r))||void 0===a||a.action(),i="SUCSESS"==(null===a||void 0===a?void 0:a.status)?function(){Object(we.navigate)("/default"),window.location.reload(),e(null)}:function(){return e(null)},o="SUCSESS"==(null===a||void 0===a?void 0:a.status)?1500:null,e({message:null===a||void 0===a?void 0:a.message,closeAction:i,timeout:o}),console.timeEnd("getSubmit");case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}var Gt=function(){var e=Object(Vt.a)(),t=e.register,n=e.setValue,a=e.handleSubmit,i=e.formState,o=Object(r.useState)(null),s=Object(c.a)(o,2),u=s[0],l=s[1],d=i.errors,f=i.touchedFields,b=i.isSubmitting;return Object(Be.jsxs)("div",{className:"login-form",children:[Object(Be.jsxs)("form",{noValidate:!0,onSubmit:a(qt(l)),children:[Object(Be.jsx)("label",{htmlFor:"inputEmail",children:"E-mail"}),Object(Be.jsx)("input",Object(Pt.a)({type:"email",id:"inputEmail"},t("email",{required:"Enter your e-mail",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,message:"Enter a valid e-mail address"}}))),d.email&&Object(Be.jsx)("p",{className:"error",children:d.email.message}),Object(Be.jsx)("label",{htmlFor:"inputPassword",children:"Password"}),Object(Be.jsx)("input",Object(Pt.a)({type:"password",id:"inputPassword"},t("password",{required:"Enter your password"}))),d.password&&Object(Be.jsx)("p",{className:"error",children:d.password.message}),Object(Be.jsxs)("div",{id:"loginForm-btn-block",children:[Object(Be.jsx)("button",{type:"submit",disabled:b,children:"Login"}),Object(Be.jsx)("button",{id:"restorePass",tabIndex:"-1",onClick:function(e){console.log("RESTOREPASS: "),n("password","RESTOREPASS"),a(),setTimeout((function(){n("password","")}),100)},disabled:!f.email||d.email,children:"\u041d\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c"})]})]}),b&&Object(Be.jsx)(Ut,{message:"\u0410\u0412\u0422\u041e\u0420\u0418\u0417\u0410\u0426\u0418\u042f ..."}),u&&Object(Be.jsx)(Ut,Object(Pt.a)({},u))]})},Ht=(n(56),n(57),d.flyersAPI_dataMap),Kt=function(e){var t;return"number"===typeof e||console.warn("WRONG FlyerID "+(null===e||void 0===e||null===(t=e.toString)||void 0===t?void 0:t.call(e)))},Jt=function(e){var t;return!!(null===e||void 0===e?void 0:e.length)||console.warn("WRONG flyersData "+(null===e||void 0===e||null===(t=e.toString)||void 0===t?void 0:t.call(e)))};function Wt(e){var t=e.flyerId,n=e.flyersData,r=e.flyersDataMap,a=void 0===r?Ht:r;if(Jt(n)){var i=n.find((function(e){return e[a.flyerId]===t}));return["flyerId","fullname","email","phone"].map((function(e){return[e,i[a[e]]]}))}}function Yt(e){var t=e.filteredSuggestions,n=e.activeSuggestion,r=e.onClick,a=e.onMouseOver,i=e.onMouseOut;return t.length?Object(Be.jsx)("ul",{className:"suggestions",children:t.map((function(e,t){var o,c=e[1];return t===n&&(o="suggestion-active",c=Object(Be.jsxs)(Be.Fragment,{children:[e[1],Object(Be.jsx)("br",{}),e[2],Object(Be.jsx)("br",{}),e[3]]})),Object(Be.jsx)("li",{className:o,onClick:r,onMouseOver:a,onMouseOut:i,"data-sindex":t,"data-id":e[0],"data-name":e[1],children:c},e[0])}))}):Object(Be.jsx)("div",{className:"no-suggestions",children:Object(Be.jsx)("em",{children:"\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u044f \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"})})}var zt=function(e){var t=e.foundId,n=e.value,r=e.setState,a=e.setFlyerInput;if(n=n.replace("NEW: ",""))return r({activeSuggestion:0,showSuggestions:!1,filteredSuggestions:[],userInput:n}),a({flyerId:t,fullname:n}),n},Xt=function(e){e.target.select()},Qt=a.a.forwardRef((function(e,t){var n=e.flyersData,a=e.initValue,i=e.setFlyerInput,o=e.ONLY_REGISTRED,s=void 0!==o&&o,u=Object(r.useState)({activeSuggestion:0,filteredSuggestions:[],showSuggestions:!1,userInput:a}),l=Object(c.a)(u,2),d=l[0],f=l[1],b=d.activeSuggestion,m=d.filteredSuggestions,j=d.showSuggestions,O=d.userInput,p=function(e){var t=e.flyersData,n=e.flyersMap,r=void 0===n?Ht:n,a=e.limit,i=void 0===a?10:a;if(Jt(t))return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ";e=e.toLowerCase();var n=r.fullname,a=["flyerId","fullname","email","phone"];return t.filter((function(t){return t[n].toLowerCase().includes(e)})).slice(0,i).map((function(e){return a.map((function(t){return e[r[t]]}))}))}}({flyersData:n,limit:5});return Object(Be.jsxs)(r.Fragment,{children:[Object(Be.jsx)("input",{ref:t,type:"text",spellCheck:!1,onFocus:Xt,onChange:function(e){var t=e.currentTarget.value,n=["NEW","NEW: "+t,"",""],r=s?Object(ke.a)(p(t)):[n].concat(Object(ke.a)(p(t)));f({filteredSuggestions:r,activeSuggestion:0,showSuggestions:!0,userInput:e.currentTarget.value})},onKeyDown:function(e){var t=d.activeSuggestion,n=d.filteredSuggestions;if(13===e.keyCode){e.preventDefault();var r=n[t];if(!r)return;var a=Number(r[0])||"NEW",o=r[1];zt({foundId:a,value:o,setState:f,setFlyerInput:i})}else if(38===e.keyCode){if(0===t)return;f((function(e){return Object(Pt.a)(Object(Pt.a)({},e),{},{activeSuggestion:t-1})}))}else if(40===e.keyCode){if(t-1===n.length)return;f((function(e){return Object(Pt.a)(Object(Pt.a)({},e),{},{activeSuggestion:t+1})}))}},placeholder:a,value:O}),j&&O&&Object(Be.jsx)(Yt,{filteredSuggestions:m,activeSuggestion:b,onClick:function(e){var t=Number(e.target.dataset.id)||"NEW",n=e.target.dataset.name;zt({foundId:t,value:n,setState:f,setFlyerInput:i})},onMouseOver:function(e){var t=e.target.dataset.sindex;e.target.className+="suggestion-active",f((function(e){return Object(Pt.a)(Object(Pt.a)({},e),{},{activeSuggestion:+t})}))},onMouseOut:function(e){e.target.className=e.target.className.replace("suggestion-active","")}})]})})),Zt=Qt,$t=Zt,en=d.flyersAPI_dataMap,tn={flyerId:"",fullname:"",lastname:"",firstname:"",secondname:"",email:"",phone:"",catid:0,notes:""},nn={"\u0425.\u0417.":0,"\u041f\u0420":1,"\u0421\u043f\u043e\u0440\u0442":2,"\u0414\u0435\u0442\u0438":3,"\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a":5,"\u0414\u0438\u043b\u0435\u0440":6,"\u0418\u043d\u043e\u0441\u0442\u0440.":9},rn=Object.keys(nn).map((function(e){return Object(Be.jsx)("option",{value:nn[e],children:e},nn[e])}));function an(e,t){t("flyerId",e.flyerId),t("fullname",e.fullname);var n=e.fullname.split(" ");["lastname","firstname","secondname"].forEach((function(e,r){var a=n[r];a&&t(e,a)}))}function on(e){var t=d.flyersAPI_dataMap;e.fullname="".concat(e.lastname," ").concat(e.firstname)+(e.secondname?" ".concat(e.secondname):"");var n=[];return Object.entries(t).forEach((function(t){var r=Object(c.a)(t,2),a=r[0],i=r[1];n[i]=e[a]})),console.log("ADD_FLYER: ",JSON.stringify(n)),function(e){return Ie.apply(this,arguments)}({flyerData:n})}var cn=function(){var e=Object(X.a)(z.a.mark((function e(t,n){var r,a;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G.dispatch(I("\u0420\u0415\u0413\u0418\u0421\u0422\u0420\u0410\u0426\u0418\u042f \n\n \u041a\u041b\u0418\u0415\u041d\u0422\u0410 \n\n...")),e.next=3,on(t);case 3:return r=e.sent,a=r.data.record,console.log("addFlyerResp: ",t,a),G.dispatch(S(a)),G.dispatch(x({EVENT:"SUBMITTED",flyerId:a[2],fullname:a[0]})),G.dispatch(I("\u041a\u041b\u0418\u0415\u041d\u0422 \n\n \u0417\u0410\u0420\u0415\u0413\u0418\u0421\u0422\u0420\u0418\u0420\u041e\u0412\u0410\u041d")),e.next=11,new Promise((function(e){return setTimeout(e,500)}));case 11:G.dispatch(I("")),un();case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function sn(e){var t,n;"HEADER"!==(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.nodeName)&&"closeFEDBtn"!==(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.id)||(G.dispatch(x({EVENT:"CANCELED"})),un())}function un(){G.dispatch(N(!1))}function ln(){var e=Object(Vt.a)({defaultValues:tn,mode:"all"}),t=e.register,n=e.formState,a=e.trigger,i=e.setValue,o=e.handleSubmit,s=e.reset,u=Object(Ee.c)(),l=Object(Ee.d)(q.flyersDataRaw),d=Object(Ee.d)(q.flyersData_editorState),f=Object(Ee.d)(q.flyersData_showModal),b=Object(r.useState)({flyerId:"",fullname:""}),m=Object(c.a)(b,2),j=m[0],O=m[1];return Object(r.useEffect)((function(){if("TOSET"===(null===d||void 0===d?void 0:d.EVENT)&&d.fullname)return an({flyerId:"NEW",fullname:null===d||void 0===d?void 0:d.fullname},i),function(){return u(x({}))}}),[u,i,d]),Object(r.useEffect)((function(){a("firstname"),j.flyerId&&(s(),"NEW"===j.flyerId?an(j,i):function(e,t,n){for(var r=e.find((function(e){return e[en.flyerId]===t.flyerId})),a=0,i=["flyerId","catid","firstname","secondname","lastname","email","phone","notes"];a<i.length;a++){var o=i[a];n(o,r[en[o]])}}(l,j,i))}),[j,l,i,a,s]),Object(Be.jsxs)("div",{id:"flyersContainer",className:"flyersContainer",onClick:sn,children:[Object(Be.jsxs)("header",{className:"flyersForm-header",children:["\u0414\u0430\u043d\u043d\u044b\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430",Object(Be.jsx)("button",{id:"closeFEDBtn",children:"X"})]}),Object(Be.jsxs)("form",{noValidate:!0,id:"flyersForm",className:"flyersForm",onSubmit:o(cn),children:[Object(Be.jsx)("input",Object(Pt.a)({type:"text",placeholder:"Id",disabled:!0},t("flyerId",{required:!0}))),d.fullnameActive&&Object(Be.jsxs)("label",{htmlFor:"autocomplete",children:["\u041a\u043b\u0438\u0435\u043d\u0442",Object(Be.jsx)($t,Object(Pt.a)(Object(Pt.a)({},t("fullname")),{},{flyersData:l,setFlyerInput:O,initValue:(null===d||void 0===d?void 0:d.fullname)||""}))]}),Object(Be.jsx)("label",{htmlFor:"lastname",children:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f"}),Object(Be.jsx)("input",Object(Pt.a)({type:"text"},t("lastname",{required:!0}))),Object(Be.jsx)("label",{htmlFor:"firstname",children:"\u0418\u043c\u044f"}),Object(Be.jsx)("input",Object(Pt.a)({type:"text"},t("firstname",{required:!0}))),Object(Be.jsx)("label",{htmlFor:"secondname",children:"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e"}),Object(Be.jsx)("input",Object(Pt.a)({type:"text"},t("secondname",{}))),Object(Be.jsx)("br",{}),Object(Be.jsx)("br",{}),Object(Be.jsx)("label",{htmlFor:"catid",children:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u0430"}),Object(Be.jsx)("select",Object(Pt.a)(Object(Pt.a)({},t("catid",{})),{},{children:rn})),Object(Be.jsx)("label",{children:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"}),Object(Be.jsx)("input",Object(Pt.a)({type:"email",placeholder:"email"},t("email",{}))),Object(Be.jsx)("input",Object(Pt.a)({type:"tel",placeholder:"phone"},t("phone",{}))),Object(Be.jsx)("label",{htmlFor:"notes",children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438"}),Object(Be.jsx)("input",Object(Pt.a)({type:"text"},t("notes",{}))),Object(Be.jsx)("br",{}),Object(Be.jsx)("br",{}),Object(Be.jsx)("button",{type:"submit",disabled:!n.isValid,children:"\u0417\u0430\u043f\u0438\u0441\u0430\u0442\u044c"}),f&&Object(Be.jsx)("div",{id:"flyerEditorModal",children:f})]})]})}var dn=ln,fn=(n(55),n(9)),bn=["---","\u0421\u0435\u0440\u0442.","\u0418\u043d\u0432\u043e\u0439\u0441","\u0420\u0435\u0437\u0435\u0440\u0432","\u041e\u043f\u043b\u0430\u0447\u0435\u043d\u043e","\u0417\u0430\u043f\u0440\u043e\u0441"],mn={1:"\u041f\u0420 \u0421\u0435\u0440\u0442",10:"\u041f\u0420 1.5",20:"\u041f\u0420 -20%",30:"\u041f\u0420",40:"\u0428\u043a\u043e\u043b\u0430",50:"\u041f\u0440\u043e\u043c\u043e",60:"\u0411\u043b-\u0442\u044c",70:"\u0421\u0442\u0430\u0444\u0444",100:"\u0421\u043f\u043e\u0440\u0442",150:"Sport",200:"Other"};function jn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.time||Date.now(),r=e.submitOptions||null,a=e.sumbitChoice||"",i=Object(Pt.a)(Object(Pt.a)(Object(Pt.a)({},t),e),{},{time:n,submitOptions:r,sumbitChoice:a});return i}function On(e,t,n){return e[n.indexOf(t)]}function pn(e){var t,n=new Date(e||Date.now()),r=s.msToSlotN(e),a=n.toISOString().substring(0,10),i=null===(t=u[r])||void 0===t?void 0:t[2];return{Flight_Date:a,TimeSlot:i,dateTimeStr:"".concat(a," ").concat(i)}}var gn=function(e){var t=e.valuesPassed,n=e.dispatch,a=e.setValue,i=e.getValues;Object(r.useEffect)((function(){if("UPDATE"===(null===t||void 0===t?void 0:t.type)){var e=i();Object.entries(t).filter((function(t){return t[1]!==e[t[0]]})).forEach((function(e){a(e[0],e[1],{shouldDirty:!0})}))}}),[t,n,a,i])},vn=function(e,t,n){var a=Object(r.useState)(e),i=Object(c.a)(a,2),o=i[0],s=i[1];return Object(r.useEffect)((function(){var t;"INIT"===(null!==(t=null===e||void 0===e?void 0:e.type)&&void 0!==t?t:"INIT")&&s(e)}),[e]),Object(r.useMemo)((function(){return t(o,n)}),[o,t,n])},hn=function(){var e=Object(X.a)(z.a.mark((function e(t){var n,r,a,i,o,c,s;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(G.dispatch(U("\u041e\u0422\u041f\u0420\u0410\u0412\u041a\u0410 \u0417\u0410\u041f\u0420\u041e\u0421\u0410 \n\n \u041d\u0410 \u0421\u0415\u0420\u0412\u0415\u0420 \n\n ...")),n=!1,r=null,i=t.sumbitChoice,o="\u0417\u0430\u043f\u0440\u043e\u0441"===t.status,console.log("SUBMIT",t),t.sumbitChoice="",t.submitOptions="",G.dispatch(V(t)),"toCancel"!==i){e.next=14;break}return e.next=12,yn(t.bookingId,o);case 12:a=e.sent,n=!0;case 14:if("toChange"!==i){e.next=18;break}return e.next=17,Tn(t,o);case 17:a=e.sent;case 18:if("toMove"!==i){e.next=23;break}return t=t.sumbitChanges.time?t:Object(Pt.a)(Object(Pt.a)({},t),{},{sumbitChanges:{time:t.time}}),e.next=22,Tn(t,o);case 22:a=e.sent;case 23:if("toNew"!==i){e.next=28;break}return r=function(e){var t=d.bookingsAPIDataMap.bookingIdCI,n=e.slice(-1)[0][t];Me({type:"@@ui/EDIT_BOOKING_CALL",payload:n})},e.next=27,xn(t,o);case 27:a=e.sent;case 28:return!0,c=500,{},"OK"===(s=a).status?(G.dispatch(U("\u0423\u0421\u041f\u0415\u0428\u041d\u041e!")),s=s.data,pe(oe(s),true),r&&r(s)):(c=3e3,G.dispatch(U("\u041e\u0428\u0418\u0411\u041a\u0410! \n\n            ".concat(a.status," \n\n            ").concat(JSON.stringify(a.data.content))))),e.next=35,new Promise((function(e){return setTimeout(e,c)}));case 35:G.dispatch(U("")),n&&In();case 37:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function yn(e){return Dn.apply(this,arguments)}function Dn(){return(Dn=Object(X.a)(z.a.mark((function e(t){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ye({bookingId:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tn(e){return Sn.apply(this,arguments)}function Sn(){return(Sn=Object(X.a)(z.a.mark((function e(t){var n,r,a,i,o,c,s,u;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.bookingId,"flyerId"in(r=t.sumbitChanges)&&(a=t.email,i=t.fullname,o=t.phone,r=Object(Pt.a)(Object(Pt.a)({},r),{},{email:a,fullname:i,phone:o})),"time"in r&&(c=pn(t.time),s=c.dateTimeStr,r=Object(Pt.a)(Object(Pt.a)({},r),{},{dateTimeStr:s})),u=Array.from(Object.entries(r)),console.log("CHANGE: ",n,u),e.abrupt("return",Te({bookingId:n,changes:u}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xn(e){return Nn.apply(this,arguments)}function Nn(){return Nn=Object(X.a)(z.a.mark((function e(t){var n,r,a,i,o,s=arguments;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]&&s[1],r=d.bookingsAPIDataMap,a=pn(t.time),i=a.dateTimeStr,o=[],Object.entries(r).forEach((function(e){var n=Object(c.a)(e,2),r=n[0],a=n[1];o[a]=t[r.replace("CI","")]})),o[r.timeCI]=i,console.log("ADD: ",JSON.stringify(o)),e.abrupt("return",xe({bookingData:o,instrMode:n}));case 8:case"end":return e.stop()}}),e)}))),Nn.apply(this,arguments)}function In(){G.dispatch(P(!1)),G.dispatch(V(jn()))}function En(e){"Escape"===e.key&&In()}function wn(e){var t=e.control,n=e.setValue,r=e.formState,a=e.buttonsText,i=Object(Vt.b)({control:t,name:"submitOptions"})||{},o=r.isDirty,s=r.isValid;console.log("SMBLOCK: ",i,o,s);var u=function(e){return n("sumbitChoice",e.target.name)},l=Object.entries(i).map((function(e){var t=Object(c.a)(e,2),n=t[0];return t[1]&&Object(Be.jsx)("button",{disabled:!s,type:"submit",name:n,onClick:u,children:a[n]},n)}));return Object(Be.jsx)("div",{id:"SubmitBlock",children:l})}var kn=Object(r.forwardRef)((function(e,t){var n=e.time,r=e.name,a=e.controls.setValue,i=pn(n);console.log(i);var o=function(e){var t=e.target.name,n=e.target.value;i[t]=n;var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"00:00",n=new Date(e),r=t.split(":"),a=Object(c.a)(r,2),i=a[0],o=a[1];return n.setUTCHours(Number(i),Number(o),0,0)}(i.Flight_Date,i.TimeSlot);a(r,o)};return Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsx)("label",{children:"\u0414\u0430\u0442\u0430 \u0438 \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u043b\u0451\u0442\u0430"}),Object(Be.jsxs)("div",{className:"side-form__inlineWrapper",children:[Object(Be.jsx)("input",{type:"date",name:"Flight_Date",placeholder:"Flight_Date",value:i.Flight_Date,onChange:o}),Object(Be.jsx)("select",{name:"TimeSlot",className:"timeslot",value:i.TimeSlot,onChange:o,children:u.map((function(e,t){return Object(Be.jsx)("option",{value:e[2],children:e[2]},t)}))})]})]})}));function Cn(e){var t=e.controls,n=e.inputName,r=e.step,a=e.min,i=e.max,o=e.children,c=t.getValues,s=t.setValue,u=t.trigger,l=r>0?"stepInputButton":"stepInputButton stepInputButton--bottom",d=o||r>0?"+":"-";return Object(Be.jsx)(Be.Fragment,{children:Object(Be.jsx)("button",{type:"button",className:l,onClick:function(e){var t=c(n)+r;a&&t<a||i&&t>i||(s(n,t),u(n))},children:d})})}function _n(e){var t=e.controls,n=e.inputName,r=t.setValue,a=t.trigger,i="quickInputBlock",o=function(e){var t=e.target.dataset.value;r(n,t),a(n)};return Object(Be.jsx)("div",{className:i,children:[5,10,15,30].map((function(e){return Object(Be.jsx)("button",{type:"button","data-value":e,onClick:o,className:i+"-button",children:e},e)}))})}function Mn(e){var t=e.getValues,n=e.setValue,r=e.trigger,a=e.register;return Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsxs)("label",{children:["\u041c\u0438\u043d\u0443\u0442\u044b",Object(Be.jsx)(Cn,{controls:{getValues:t,setValue:n,trigger:r},inputName:"timeVal",step:1}),Object(Be.jsx)("input",Object(Pt.a)(Object(Pt.a)({},a("timeVal",{required:!0,valueAsNumber:!0,min:1})),{},{type:"number",min:"0",onFocus:function(e){return e.target.select()}})),Object(Be.jsx)(Cn,{controls:{getValues:t,setValue:n,trigger:r},inputName:"timeVal",step:-1,min:1})]}),Object(Be.jsx)(_n,{controls:{setValue:n,trigger:r},inputName:"timeVal"})]})}function An(e){var t=e.formProps,n=t.handleSubmit,a=t.register,i=t.getValues,o=t.setValue,c=t.trigger,s=t.control,u=t.formState,l=t.setFlyerInput,d=t.SUBMIT_BUTTONS_TEXT,f=t.time,b=t.flyersData,m=t.flyerInput,j=t.bookingEditorModal;return Object(Be.jsxs)("div",{id:"sidebar",className:"sidebar",onKeyDown:En,tabIndex:"0",children:[Object(Be.jsxs)("header",{className:"sidebar-header",children:["\u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",Object(Be.jsx)("button",{id:"closeSidebarBtn",onClick:In,children:"X"})]}),Object(Be.jsxs)("form",{noValidate:!0,className:"side-form",onSubmit:n(hn),children:[Object(Be.jsxs)("div",{id:"bookingIdDiv",className:"side-form__inlineWrapper",children:[Object(Be.jsx)("label",{id:"bookingId-label",children:"ID: "}),Object(Be.jsx)("input",Object(Pt.a)(Object(Pt.a)({},a("bookingId")),{},{disabled:!0,type:"number",placeholder:" NEW"}))]}),Object(Be.jsx)(kn,Object(Pt.a)(Object(Pt.a)({},a("time",{required:!0})),{},{controls:{setValue:o},time:f})),Object(Be.jsxs)("div",{className:"side-form__inlineWrapper",children:[Object(Be.jsx)(Mn,{register:a,getValues:i,setValue:o,trigger:c}),Object(Be.jsxs)("label",{children:["\u0422\u0430\u0440\u0438\u0444",Object(Be.jsx)("select",Object(Pt.a)(Object(Pt.a)({},a("tarif",{required:!0})),{},{children:Object.entries(mn).map((function(e){var t=e[1],n=e[0];return Object(Be.jsx)("option",{value:t,children:t},n)}))})),"\u041e\u043f\u043b\u0430\u0442\u0430",Object(Be.jsx)("select",Object(Pt.a)(Object(Pt.a)({},a("status")),{},{children:bn.map((function(e,t){return Object(Be.jsx)("option",{value:e,children:e},t)}))}))]})]}),Object(Be.jsx)("label",{id:"fullnameLabel",htmlFor:"fullname",children:"\u041a\u043b\u0438\u0435\u043d\u0442"}),Object(r.createElement)(Zt,Object(Pt.a)(Object(Pt.a)({},a("fullname",{required:!0})),{},{key:m.fullname,initValue:m.fullname,flyersData:b,setFlyerInput:l})),Object(Be.jsx)("label",{htmlFor:"notes",children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438"}),Object(Be.jsx)("input",Object(Pt.a)({type:"text"},a("notes",{required:!1}))),Object(Be.jsx)(wn,{control:s,setValue:o,getValues:i,formState:u,buttonsText:d})]}),j&&Object(Be.jsx)("div",{id:"bookingEditorModal",children:j})]})}var Bn={toCancel:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",toMove:"\u041f\u0435\u0440\u0435\u043d\u0435\u0441\u0442\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",toChange:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",toNew:"\u0417\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u043a\u0430\u043a \u043d\u043e\u0432\u043e\u0435"},Pn={bookingId:"",history:"",time:0,timeVal:0,tarif:"\u041f\u0420",fullname:"",notes:"",status:"---",flyerId:0,email:"",phone:""},Vn=["bookingId","flyerId","time","timeVal","tarif","status","notes"];var Un=function(){var e=Object(Ee.c)(),t=Object(Ee.d)(q.flyersDataRaw),n=Object(Ee.d)(q.flyersData_editorState),a=Object(Ee.d)(q.sidebar_curObj),i=vn(a,jn,Pn),o=Object(Ee.d)(q.booking_showModal),s=Object(Vt.a)({defaultValues:i,mode:"all"}),u=s.register,l=s.control,d=s.trigger,f=s.setValue,b=s.getValues,m=s.watch,j=s.handleSubmit,O=s.formState,p=Object(r.useState)({flyerId:i.flyerId,fullname:i.fullname}),g=Object(c.a)(p,2),v=g[0],h=g[1];u("flyerId",{validate:function(e){return"TOSET"!==e}}),function(e){var t=e.dispatch,n=e.setValue,a=e.trigger,i=e.flyerEditorState,o=e.flyersData,c=e.flyerInput,s=e.setFlyerInput;Object(r.useEffect)((function(){var e=i.EVENT,t=i.flyerId,n=i.fullname;"SUBMITTED"!==e||s({flyerId:t,fullname:n})}),[t,n,s,i]),Object(r.useEffect)((function(){if(Jt(o)){var e=c.flyerId;if("TOSET"!==e){if("NEW"===e)return s({flyerId:"TOSET"}),t(x({EVENT:"TOSET",fullnameImputActive:!1,fullname:c.fullname})),void t(N(!0));Kt(e)&&(Wt({flyerId:e,flyersData:o}).forEach((function(e){return n(e[0],e[1])})),a("fullname"))}}}),[t,n,a,o,c,s])}({dispatch:e,trigger:d,setValue:f,setFlyerInput:h,flyerEditorState:n,flyersData:t,flyerInput:v});var y=m(Vn),D=On(y,"time",Vn);gn({valuesPassed:a,dispatch:e,setValue:f,getValues:b}),Object(r.useEffect)((function(){return e(F(D)),function(){return e(F(null))}}),[e,D]),Object(r.useEffect)((function(){!function(e){var t=e.values,n=e.watchedFields,r=e.initialValues,a=e.setValue,i=n.reduce((function(e,n,a){return t[a]===r[n]?e:Object(Pt.a)(Object(Pt.a)({},e),{},Object(fn.a)({},n,t[a]))}),{}),o=!!Object.entries(i).length,c=r.submitOptions?r.submitOptions:o?{toChange:!i.time,toMove:!!i.time,toNew:!0}:{toCancel:!0};a("submitOptions",c),(o||c.toMove)&&a("sumbitChanges",i)}({values:y,watchedFields:Vn,initialValues:i,setValue:f})}),[y,i,f]),console.log("BER RENDER",i,b());var T={handleSubmit:j,register:u,getValues:b,setValue:f,trigger:d,control:l,formState:O,setFlyerInput:h,SUBMIT_BUTTONS_TEXT:Bn,time:D,flyersData:t,flyerInput:v,bookingEditorModal:o};return Object(Be.jsx)(An,{formProps:T})},Fn={toCancel:"\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u043e\u0442\u043c\u0435\u043d\u0443",toMove:"\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u043f\u0435\u0440\u0435\u043d\u043e\u0441",toChange:"\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0438\u0437\u043c\u0435\u043d\u0443",toNew:"\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u043d\u043e\u0432\u043e\u0435"},Rn={bookingId:"",history:"",time:0,timeVal:15,tarif:"\u0421\u043f\u043e\u0440\u0442",fullname:"",notes:"",status:"\u0417\u0430\u043f\u0440\u043e\u0441",flyerId:0,email:"",phone:""},Ln=["bookingId","flyerId","time","timeVal","tarif","status","notes"],qn=function(e,t){var n=jn(e,t);pn(n.time);return n.submitOptions={toNew:!0},n};var Gn=function(){var e=Object(Ee.c)(),t=Object(Ee.d)(q.flyersDataRaw),n=Object(Ee.d)(q.sidebar_curObj),a=vn(n,qn,Rn),i=Object(Ee.d)(q.booking_showModal),o=Object(Vt.a)({defaultValues:a,mode:"all"}),s=o.register,u=o.control,l=o.trigger,d=o.setValue,f=o.getValues,b=o.watch,m=o.handleSubmit,j=o.formState,O=Object(r.useState)({flyerId:a.flyerId,fullname:a.fullname}),p=Object(c.a)(O,2),g=p[0],v=p[1];s("flyerId",{validate:function(e){return"TOSET"!==e}});var h=b(Ln),y=On(h,"time",Ln);gn({valuesPassed:n,dispatch:e,setValue:d,getValues:f}),function(e){var t=e.dispatch,n=e.setValue,a=e.trigger,i=e.flyersData,o=e.flyerInput;Object(r.useEffect)((function(){var e=o.flyerId;"TOSET"!==e&&Kt(e)&&Jt(i)&&(Wt({flyerId:e,flyersData:i}).forEach((function(e){return n(e[0],e[1])})),a("fullname"))}),[t,n,a,i,o])}({flyersData:t,flyerInput:g,dispatch:e,setValue:d,trigger:l}),Object(r.useEffect)((function(){return e(F(y)),function(){return e(F(null))}}),[e,y]),Object(r.useEffect)((function(){!function(e){var t=e.values,n=e.watchedFields,r=e.initialValues,a=e.setValue,i=n.reduce((function(e,n,a){return t[a]===r[n]?e:Object(Pt.a)(Object(Pt.a)({},e),{},Object(fn.a)({},n,t[a]))}),{}),o=!!Object.entries(i).length;a("submitOptions",r.bookingId?{toCancel:!0,toNew:!0}:r.submitOptions),o&&a("sumbitChanges",i)}({values:h,watchedFields:Ln,initialValues:a,setValue:d})}),[h,a,d]);var D={handleSubmit:m,register:s,getValues:f,setValue:d,trigger:l,control:u,formState:j,setFlyerInput:v,SUBMIT_BUTTONS_TEXT:Fn,time:y,flyersData:t,flyerInput:g,bookingEditorModal:i};return Object(Be.jsx)(An,{formProps:D})};Object(we.setBasepath)(d.BASE_PATH);var Hn={"*bookings":function(){return{mode:"bookings",Content:Nt}},"*freetime":function(){return{mode:"freetime",Content:Bt}},"*login":function(){return{mode:"login",Content:Gt}},default:function(){return{mode:"bookings",Content:Nt}}};var Kn=function(){Object(we.useRedirect)("/*","/bookings");var e=Object(Ee.d)(q.userObj);e.role||Object(we.navigate)("/login");var t="admin"===e.role,n=Object(we.useRoutes)(Hn)||Hn.default(),a=n.mode,i=n.Content,o=Object(Ee.d)(q.sidebar_isToggled),u=Object(Ee.d)(q.flyersData_showEditor),l=Object(r.useState)(0),f=Object(c.a)(l,2),b=f[0],m=f[1];return Ae("@@ui/ADDREC_BTN",(function(e){var t=function(e){var t=e;for(;"TR"!==t.nodeName;)t=t.parentNode;for(;!t.id;)t=t.previousElementSibling;return t}(e.payload).id.split("_"),n=Object(c.a)(t,2),r=n[0],a=n[1].split(":"),i=Object(c.a)(a,2),o=i[0];Jn(864e5*r+6e4*(+i[1]+60*o))})),Ae("@@ui/EDIT_BOOKING_CALL",(function(e){!function(e,t){var n=G.getState().mainState.bookingsData.arr,r=d.bookingsArrMap,a=function(e,t,n){var r=e.find((function(e){return e[t.bookingIdCI]===n})),a={};for(var i in t)a[i.replace("CI","")]=r[t[i]];return a}(n,r,e);G.dispatch(V(a)),t((function(e){return e+1})),G.dispatch(P(!0))}(Number(null===e||void 0===e?void 0:e.payload),m)})),Ae("@@ui/FT_CELL_CLICK",(function(e){Jn(e.payload)})),Ae("@@ui/HOME_BTN_click",(function(e){var t=s.dateMsToDateN(Date.now());G.dispatch(C(t))})),Ae("@@ui/TEST_BTN4",(function(e){je({}).then((function(e){return console.log((Date.now()-e.data)/1e3)})).catch((function(e){return console.log(e)}))})),Object(Be.jsxs)("div",{className:"App",children:[Object(Be.jsx)(tt,{mode:a}),Object(Be.jsxs)("div",{id:"ContentWrapperAll",children:[Object(Be.jsx)("div",{id:"ContentWrapperInner",children:Object(Be.jsx)("div",{id:"inner",className:"inner",children:Object(Be.jsx)(i,{})})}),o&&(t?Object(Be.jsx)(Un,{},b):Object(Be.jsx)(Gn,{},b)),u&&t&&Object(Be.jsx)(dn,{},1)]}),Object(Be.jsx)(Le,{})]})};function Jn(e){var t=q.sidebar_isToggled(G.getState())?q.sidebar_curObj(G.getState()):null;if((null===t||void 0===t?void 0:t.time)!==e){var n=t?{type:"UPDATE",time:e,submitOptions:{toNew:!0,toMove:!0}}:{type:"INIT",time:e,flyerId:"TOSET",submitOptions:{toNew:!0}};G.dispatch(V(n)),G.dispatch(P(!0))}}function Wn(){document.documentElement.style.setProperty("--vh",.01*window.innerHeight+"px")}function Yn(){return zn.apply(this,arguments)}function zn(){return(zn=Object(X.a)(z.a.mark((function e(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Wn(),Qn(),Xn(),$n(),ge();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xn(){o.a.render(Object(Be.jsx)(Ee.a,{store:G,children:Object(Be.jsx)(Kn,{})}),document.getElementById("root"))}function Qn(){if(localStorage.getItem("name")&&localStorage.getItem("role")){var e={name:localStorage.getItem("name"),ps:localStorage.getItem("ps"),mail:localStorage.getItem("mail"),role:localStorage.getItem("role")};return G.dispatch(h(e)),e}}function Zn(){be($n())}function $n(e){var t=q.period(G.getState());return!e&&t.reqDate||(t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=new Date(e);t.setDate(t.getDate()-7);var n=new Date(e);return n.setDate(n.getDate()+21),e=s.dateToYYYYMMDD(e,"-"),t=s.dateToYYYYMMDD(t,"-"),n=s.dateToYYYYMMDD(n,"-"),G.dispatch(y({reqDate:e,stDate:t,endDate:n})),be({stDate:t,endDate:n}),{reqDate:e,stDate:t,endDate:n}}(e)),t}window.addEventListener("error",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global",n=e.error&&e.error.stack,r="ERR_logger ".concat(t,": \n")+"".concat(e&&e.error||e);return n&&(r+="\n"+n),"object"===typeof r&&(r=JSON.stringify(r)),console.trace(r),r})),window.addEventListener("resize",Wn),window.onload=Yn}},[[58,1,2]]]);
//# sourceMappingURL=main.a05f06f3.chunk.js.map